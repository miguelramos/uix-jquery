/**
 *  ─────╔╗╔═╗─╔╗──╔╗
 *	╔╦╦╦═╣╚╣═╬╦╣╚╦╗╠╬══╦═╗╔═╦═╦══╗
 *	║║║║╩╣╬╠═║║║╬║╚╣║║║║╩╬╣═╣╬║║║║
 *	╚══╩═╩═╩═╩═╩═╩═╩╩╩╩╩═╩╩═╩═╩╩╩╝
 * ------------------------------------------------------------------------------------
 * widget.gmaps.js
 * ------------------------------------------------------------------------------------
 *
 * @package UIX GMAPS
 * @author  Miguel Ramos <miguel.marques.ramos@gmail.com>
 * @link    https://www.websublime.com
 * @version 0.0.3
 */var MAP_PIN="M0-165c-27.618 0-50 21.966-50 49.054C-50-88.849 0 0 0 0s50-88.849 50-115.946C50-143.034 27.605-165 0-165z",SQUARE_PIN="M 50 -119.876 -50 -119.876 -50 -19.876 -13.232 -19.876 0.199 0 13.63 -19.876 50 -19.876 Z",SHEILD="M42.8-72.919c0.663-7.855 3.029-15.066 7.2-21.675L34.002-110c-5.054 4.189-10.81 6.509-17.332 6.919 c-5.976 0.52-11.642-0.574-16.971-3.287c-5.478 2.626-11.121 3.723-17.002 3.287c-6.086-0.523-11.577-2.602-16.495-6.281 l-16.041 15.398c3.945 6.704 6.143 13.72 6.574 21.045c0.205 3.373-0.795 8.016-3.038 14.018c-1.175 3.327-2.061 6.213-2.667 8.627 c-0.562 2.394-0.911 4.34-1.027 5.801c-0.082 6.396 1.78 12.168 5.602 17.302c2.986 3.745 7.911 7.886 14.748 12.41 c7.482 3.665 13.272 6.045 17.326 7.06c1.163 0.521 2.301 1.025 3.363 1.506C-7.9-5.708-6.766-5.232-5.586-4.713 C-3.034-3.242-1.243-1.646-0.301 0C0.858-1.782 2.69-3.338 5.122-4.713c1.717-0.723 3.173-1.346 4.341-1.896 c1.167-0.494 2.037-0.865 2.54-1.09c0.866-0.414 2.002-0.888 3.376-1.41c1.386-0.527 3.101-1.168 5.144-1.882 c3.951-1.348 6.83-2.62 8.655-3.77c6.634-4.524 11.48-8.595 14.566-12.235c3.958-5.152 5.879-10.953 5.79-17.475 c-0.232-2.922-1.52-7.594-3.85-13.959C43.463-64.631 42.479-69.445 42.8-72.919z",ROUTE="M49.986-58.919c-0.51-27.631-16.538-38.612-17.195-39.049l-2.479-1.692l-2.5 1.689c-4.147 2.817-8.449 4.247-12.783 4.247 c-7.178 0-12.051-3.864-12.256-4.032L-0.023-100l-2.776 2.248c-0.203 0.165-5.074 4.028-12.253 4.028 c-4.331 0-8.63-1.429-12.788-4.253l-2.486-1.678l-2.504 1.692c-1.702 1.17-16.624 12.192-17.165 38.907 C-50.211-56.731-43.792-12.754-0.003 0C47.609-13.912 50.23-56.018 49.986-58.919z",ROUNDED="M50-80c0-11-9-20-20-20h-60c-11 0-20 9-20 20v60c0 11 9 20 20 20h60c11 0 20-9 20-20V-80z";(function(e){e.widget("uix.gmaps",{options:{version:"0.0.3",debug:!0,iconSize:16,iconColor:"#fff",iconSymbol:null,enableInfoBox:!0,google:{zoom:12,center:new google.maps.LatLng(41.358773,-8.753555),mapTypeId:google.maps.MapTypeId.ROADMAP}},_create:function(){var t;this.el=this.element[0];t=this;this._setAttributes();this.instance={map:new google.maps.Map(t.el,t.options.google),markers:[],overlays:[],services:[]};google.maps.event.addListenerOnce(t.instance.map,"bounds_changed",function(){e(t.el).trigger("init",t.instance.map)});t._call(t.options.callback,t.instance.map);this.options.debug&&console.log(this)},_setAttributes:function(){this.element.data("iconSize")&&this._setIconSize(this.element.data("iconSize"));this.element.data("iconColor")&&this._setIconColor(this.element.data("iconColor"));this.element.data("iconSymbol")&&this._setIconSymbol(this.element.data("iconSymbol"))},_setOption:function(t,n){switch(t){case"iconSize":this.options.iconSize=this._setIconSize(n);break;case"iconColor":this.options.iconColor=this._setIconColor(n);break;case"iconSymbol":this.options.iconSymbol=this._setIconSymbol(n);break;case"enableInfoBox":this.options.enableInfoBox=this._setEnableInfoBox(n)}e.Widget.prototype._setOption.apply(this,arguments);this._super("_setOption",t,n)},_setIconSize:function(e){typeof e=="number"&&(this.options.iconSize=e)},_setIconColor:function(e){return strpos(e,"#")!==!1?e:"#fff"},_setIconSymbol:function(e){return typeof e=="string"?e:null},_setEnableInfoBox:function(e){return typeof e=="boolean"?e:!0},addBounds:function(e){var t=this.get("bounds",new google.maps.LatLngBounds);t.extend(this._latLng(e));this.get("map").fitBounds(t);return this},addMarker:function(t,n){var r,i;t.map=this.get("map");t.position=this._latLng(t.position);r=new(t.marker||google.maps.Marker)(t);i=this.get("markers");this._overlay({map:t.map,marker:r,text:t.label});r.id?i[r.id]=r:i.push(r);r.bounds&&this.addBounds(r.getPosition());this._call(n,t.map,r);return e(r)},openInfoWindow:function(e,t,n){var r;if(this.options.enableInfoBox){r=this.get("iw",e.infoWindow||new InfoBox);e=this._createInfoBox(e)}else r=this.get("iw",e.infoWindow||new google.maps.InfoWindow);r.setOptions(e);r.open(this.get("map"),this._unwrap(t));this._call(n,r);return this},closeInfoWindow:function(){this.get("iw")!=null&&this.get("iw").close();return this},_createInfoBox:function(t){var n,r,i,s,o,u=this.get("iw"),a={disableAutoPan:!1,maxWidth:0,pixelOffset:new google.maps.Size(-225,-70),alignBottom:!0,zIndex:null,closeBoxMargin:"10px 2px 2px 2px",closeBoxURL:"",infoBoxClearance:new google.maps.Size(1,1),isHidden:!1,pane:"floatPane",enableEventPropagation:!1};t=e.extend(a,t);n=e("div").tag({"class":"uix-info-box"}),r=e("header").tag({"class":"uix-info-head"}),i=e("div").tag({"class":"uix-info-content"}),s=e("div").tag({"class":"uix-info-caret"}).append('<i class="fa fa-caret-down"></i>'),o=e("i").tag({"class":"fa fa-times"}).css("cursor","pointer");google.maps.event.addListener(u,"domready",function(){google.maps.event.addDomListener(document.querySelector(".fa-times"),"click",function(e){e.cancelBubble=!0;e.stopPropagation&&e.stopPropagation();google.maps.event.trigger(u,"closeclick");u.close()})});i.append(t.content);r.append(t.title).append(o);n.append(r).append(i).append(s);t.content=n.get(0).outerHTML;return t},_overlay:function(t){var n,r=this,i=function(e){this.setValues(e);this.div=document.createElement("div");this.div.className="marker-label";var t=document.createElement("span");t.className="marker-icon";this.div.appendChild(t)};i.prototype=e.extend(new google.maps.OverlayView,{onAdd:function(){var e;this.getPanes().overlayImage.appendChild(this.div);e=this;this.listeners=[google.maps.event.addListener(this,"position_changed",function(){e.draw()}),google.maps.event.addListener(this,"text_changed",function(){e.draw()}),google.maps.event.addListener(this,"zindex_changed",function(){e.draw()})]},onRemove:function(){var e,t;this.div.parentNode.removeChild(this.div);for(e=0,t=this.listeners.length;e<t;++e)google.maps.event.removeListener(this.listeners[e])},draw:function(){var e=this.getProjection(),t=this.div,n=e.fromLatLngToDivPixel(this.get("position")),i=r.options.iconSize,s=r.options.iconColor;t.style.top=Math.floor(n.y)+"px";t.style.left=Math.floor(n.x)+"px";t.style.fontSize=i+"px";t.style.display="block";t.style.position="absolute";t.style.color=s;t.style.zIndex=999;t.style.whiteSpace="nowrap";t.style.textAlign="center";this.div.innerHTML=this.get("text").toString()}});n=new i(t);n.bindTo("position",t.marker,"position");return n},get:function(e,t){var n,r,i=this.instance;if(!i[e]){if(e.indexOf(">")>-1){n=e.replace(/ /g,"").split(">");for(r=0;r<n.length;r++){if(!i[n[r]]){if(!t)return null;i[n[r]]=r+1<n.length?[]:t}i=i[n[r]]}return i}t&&!i[e]&&this.set(e,t)}return i[e]},set:function(e,t){this.instance[e]=t;return this},refresh:function(){var t=this.get("map"),n=t.getCenter();e(t).triggerEvent("resize");t.setCenter(n);return this},destroy:function(){e.Widget.prototype.destroy.call(this)},_latLng:function(e){if(!e)return new google.maps.LatLng(0,0);if(e instanceof google.maps.LatLng)return e;e=e.replace(/ /g,"").split(",");return new google.maps.LatLng(e[0],e[1])},_call:function(t){t&&e.isFunction(t)&&t.apply(this,Array.prototype.slice.call(arguments,1))},_unwrap:function(t){return t?t instanceof jQuery?t[0]:t instanceof Object?t:e("#"+t)[0]:null}});e.fn.extend({triggerEvent:function(e){google.maps.event.trigger(this[0],e);return this},addEventListener:function(e,t,n){google.maps&&this[0]instanceof google.maps.MVCObject?google.maps.event.addListener(this[0],e,t):n?this.bind(e,t,n):this.bind(e,t);return this}});e.each("click rightclick dblclick mouseover mouseout drag dragend".split(" "),function(e,t){jQuery.fn[t]=function(e,n){return this.addEventListener(t,e,n)}})})(jQuery);